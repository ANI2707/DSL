#include<iostream>
#include<string.h>
using namespace std;
class club
{
    private:
    struct member
    {
        char name[30];
        int prn;
        member *next;

    };
    member *head=new member, *tail=new member;
    public:
    club()
    {
        strcpy(head->name, "None");
        strcpy(tail->name, "None");
        head->prn=0;
        tail->prn=0;
        head->next=tail;
        tail->next=NULL;
    }
    void addPresident(char name[30],int prn)
    {
        strcpy(head->name,name);
        head->prn=prn;
    }
    void addSecretary(char name[30],int prn)
    {
        strcpy(tail->name,name);
        tail->prn=prn;
    }
    void addMember(int prn,char name[30])
    {
        member *tmp=new member;
        strcpy(tmp->name,name);
        tmp->prn=prn;
        tmp->next=tail;
        member *tmp2=head;
        while (tmp2->next !=tail)
        {
            tmp2=tmp2->next;
        }
        tmp2->next=tmp;
    }
    void delPresident()
    {
        if(head->name=="None")
        {
            cout<<"There is no president to remove from the club"<<endl;
        }
        else
        {
            cout<<"President"<<head->name<<" (PRN - " <<head->prn<<") has been removed from the club."<<endl;
            strcpy(head->name,"None");
            head->prn=0;
        }
    }
    void delSecretary()
    {
        if(tail->name=="None")
        {
            cout<<"There is no secretary to remove from the club"<<endl;
        }
        else
        {
            cout<<"Secretary"<<tail->name<<"(PRN - "<<tail->prn<<") has been removed from the club."<<endl;
            strcpy(tail->name,"None");
            tail->prn=0;
        }

    }
    void delMember(char name[30])
    {
        member *tmp,*p;
        tmp=head;
        if(strcmp(head->name,"None")==0 && strcmp(tail->name,"None")==0 && head->next==tail)
        {
            cout<<"No members in the club"<<endl;
        }
        else
        {
            while (tmp !=NULL)
            {
                if(strcmp(head->name,name)==0)
                {
                    cout<<"The President cannot be removed with this. Please use:\n4.Remove President."<<endl;
                    break;
                }
                else if(strcmp(tail->name,name)==0)
                {
                    cout<<"The Secretary cannot be removed with this.Please use:\n5.Remove Secretary."<<endl;
                    break;
                }
                else if(strcmp(tmp->name,name)==0)
                {
                    cout<<"Member "<<tmp->name<<" (PRN - "<<tmp->prn<<")"<<"is removed from the club."<<endl;
                    p->next=tmp->next;
                    delete tmp;
                    break;
                }
                else
                {
                    p=tmp;
                    tmp=tmp->next;
                }
                if(tmp==NULL)
                {
                    cout<<"Member not found"<<endl;
                }
            }
            
        }
    }
    void display()
    {
        member *tmp;
        tmp=head;
        if(strcmp(head->name,"None")==0 && strcmp(tail->name,"None")==0 && head->next ==tail)
        {
            cout<<"No members in the club"<<endl;
        }
        else
        {
            while(tmp !=NULL)
            {
                if(tmp==head)
                {
                    cout<<"President :"<<tmp->name<<" (PRN - "<<tmp->prn<<")"<<endl;
                    tmp=tmp->next;               
                }
                else if(tmp->next==NULL)
                {
                    cout<<"Secretary :"<<tmp->name<<" (PRN - "<<tmp->prn<<")"<<endl;
                    tmp=tmp->next;
                }
                else
                {
                    cout<<"Member :"<<tmp->name<<" (PRN - "<<tmp->prn<<")"<<endl;
                    tmp=tmp->next;
                }
            }
        }
    }
    void count()
    {
        int count=0;
        member *tmp;
        tmp=head;
        if(strcmp(head->name,"None")==0 && strcmp(tail->name,"None")==0 && head->next ==tail)
        {
            count=0;
        }
        else if((strcmp(head->name, "None")==0 || strcmp(tail->name, "None")==0) && head->next==tail)
        {
            count=1;
        }
        else
        {
            while(tmp!=NULL)
            {
                count++;
                tmp=tmp->next;
            }
        }
        cout<<"Total number of members :"<<count<<endl;
    }
    void concatenate(club c1,club c2)
    {
        member *tmp,*tmp2;
        tmp=c1.head;
        while(tmp !=NULL)
        {
            addMember(tmp->prn,tmp->name);
            tmp=tmp->next;
        }
        tmp=c2.head;
        while(tmp !=NULL)
        {
            addMember(tmp->prn,tmp->name);
            tmp=tmp->next;
        }
    }
};
void menu(club c)
{
    int choice;
    char name[30];
    int prn;
    do
    {
        cout<<"\nWhat do you want to do?"<<endl;
        cout<<"1.Add President"<<endl;
        cout<<"2.Add Secretary"<<endl;
        cout<<"3.Add Member"<<endl;
        cout<<"4.Remove President"<<endl;
        cout<<"5.Remove Secretary"<<endl;
        cout<<"6.Remove member"<<endl;
        cout<<"7.Display members"<<endl;
        cout<<"8.Count members"<<endl;
        cout<<"9.Exit"<<endl;
        cout<<"\nEnter your choice(1-9) : ";
        cin>>choice;
        switch(choice)
        {
            case 1:
            cout<<"Enter name of the president :";
            (cin>>ws).getline(name,30);
            cout<<"Enter PRN of the president :";
            cin>>prn;
            c.addPresident(name,prn);
            break;

            case 2:
            cout<<"Enter name of the secretary :";
            (cin>>ws).getline(name,30);
            cout<<"Enter PRN of the secretary :";
            cin>>prn;
            c.addSecretary(name,prn);
            break;

            case 3:
            cout<<"Enter Name :";
            (cin>>ws).getline(name,30);
            cout<<"Enter PRN :";
            cin>>prn;
            c.addMember(prn,name);
            break;

            case 4:
            c.delPresident();
            break;

            case 5:
            c.delSecretary();
            break;

            case 6:
            cout<<"Enter Name :";
            (cin>>ws).getline(name,30);
            c.delMember(name);
            break;

            case 7:
            cout<<"Members of the Pinnacle Club from this class are :"<<endl;
            c.display();
            break;

            case 8:
            c.count();
            break;

            case 9:
            cout<<"Exiting the class"<<endl;
            break;
            default:
            cout<<"Invalid choice"<<endl;
        }
    } while (choice !=9);
}
int main()
{
    int choice;
    club class1,class2,conclass;
    cout<<"Welcome to Pinnacle Club!"<<endl;
    do
    {
        cout<<"\nWhich class do you want to work with?"<<endl;
        cout<<"1.Class A"<<endl;
        cout<<"2.Class B"<<endl;
        cout<<"3.Concatenate the two classes"<<endl;
        cout<<"4.Exit"<<endl;
        cout<<"Enter your choice(1/2/3/4) :";
        cin>>choice;
        switch (choice)
        {
            case 1:
            menu(class1);
            break;
            case 2:
            menu(class2);
            break;
            case 3:
            conclass.concatenate(class1,class2);
            cout<<"Concatenated class :"<<endl;
            conclass.display();
            break;
            case 4:
            cout<<"Exiting ......"<<endl;
            break;
            default:
            cout<<"Invalid choice"<<endl;
            break;
        }
    } while (choice !=4);
    cout<<"\nThank you !!!\n\t\t-Pinnacle Club"<<endl;
    getchar();
    return 0;
}
